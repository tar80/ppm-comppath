Array.prototype.includes||(Array.prototype.includes=function(e,r){if(null==this)throw new Error('Array.includes: "this" is null or not defined');var t=Object(this),n=t.length>>>0;if(0===n)return!1;var i=null!=r?r:0,u=Math.max(i>=0?i:n-Math.abs(i),0);function sameValueZero(e,r){return e===r||"number"==typeof e&&"number"==typeof r&&isNaN(e)&&isNaN(r)}for(;u<n;){if(sameValueZero(t[u],e))return!0;u++}return!1});var validArgs=function(){for(var e=[],r=PPx.Arguments;!r.atEnd();r.moveNext())e.push(r.value);return e},safeArgs=function(){for(var e=[],r=validArgs(),t=0,n=arguments.length;t<n;t++)e.push(_valueConverter(t<0||arguments.length<=t?undefined:arguments[t],r[t]));return e},_valueConverter=function(e,r){if(null==r||""===r)return null!=e?e:undefined;switch(typeof e){case"number":var t=Number(r);return isNaN(t)?e:t;case"boolean":return null!=r&&"false"!==r&&"0"!==r;default:return r}},e={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},r={tempKey:"K_ppmTemp",tempMenu:"M_ppmTemp",lfDset:"ppm_lfdset",virtualEntry:"ppm_ve"},tmp=function(){var e=PPx.Extract('%*extract(C,"%%*temp()")');return{dir:e,file:e+"_ppmtemp",lf:e+"_temp.xlf",stdout:e+"_stdout",stderr:e+"_stderr",ppmDir:function(){var e=PPx.Extract("%'temp'%\\ppm");return PPx.Execute("*makedir "+e),e}}},isEmptyStr=function(e){return""===e},t=PPx.CreateObject("Scripting.FileSystemObject"),n={TypeToCode:{crlf:"\r\n",cr:"\r",lf:"\n"},CodeToType:{"\r\n":"crlf","\r":"cr","\n":"lf"},Ppx:{lf:"%%bl",cr:"%%br",crlf:"%%bn",unix:"%%bl",mac:"%%br",dos:"%%bn","\n":"%%bl","\r":"%%br","\r\n":"%%bn"},Ascii:{lf:"10",cr:"13",crlf:"-1",unix:"10",mac:"13",dos:"-1","\n":"10","\r":"13","\r\n":"-1"}},isCV8=function(){return"ClearScriptV8"===PPx.ScriptEngineName},_exec=function(e,r){try{var t;return[!1,null!=(t=r())?t:""]}catch(n){return[!0,""]}finally{e.Close()}},writeLines=function(r){var i=r.path,u=r.data,a=r.enc,l=void 0===a?"utf8":a,o=r.append,c=void 0!==o&&o,p=r.overwrite,f=void 0!==p&&p,s=r.linefeed,m=void 0===s?e.nlcode:s;if(!f&&!c&&t.FileExists(i))return[!0,i+" already exists"];var d,x=t.GetParentFolderName(i);if(t.FolderExists(x)||PPx.Execute("*makedir "+x),"utf8"===l){if(isCV8()){var v=u.join(m),P=c?"AppendAllText":"WriteAllText";return[!1,NETAPI.System.IO.File[P](i,v)]}var h=f||c?2:1,b=PPx.CreateObject("ADODB.Stream");d=_exec(b,(function(){b.Open(),b.Charset="UTF-8",b.LineSeparator=Number(n.Ascii[m]),c?(b.LoadFromFile(i),b.Position=b.Size,b.SetEOS):b.Position=0,b.WriteText(u.join(m),1),b.SaveToFile(i,h)}))[0]}else{var y=c?8:f?2:1;t.FileExists(i)||PPx.Execute("%Osq *makefile "+i);var E="utf16le"===l?-1:0,S=t.GetFile(i).OpenAsTextStream(y,E);d=_exec(S,(function(){S.Write(u.join(m)+m)}))[0]}return d?[!0,"Could not write to "+i]:[!1,""]},main=function(){for(var e=safeArgs("0","1234567890"),t=e[0],n=e[1],i=r.tempMenu,u=tmp().file,a=n.split(""),l=a[0],o=[],c=[i+"\t= {"],p=getDirection(t);;){var f=PPx.Extract("%*dirhistory("+p()+")");if(isEmptyStr(f))break;if(!o.includes(f)){var s=getSubid(a.splice(0,1),f);c.push(s+"\t= "+f),o.push(f)}}c.push("}"),writeLines({path:u,data:c,overwrite:!0}),PPx.Execute("*setcust @"+u);var m=PPx.Extract("%*menu("+i+","+l+")");isEmptyStr(m)||PPx.Execute("*jumppath "+m),PPx.Execute('*deletecust "'+i+'"%:%K"@LOADCUST"')},getDirection=function(e){var r="1"===e,t=r?-1:0;return r?function(){return t--}:function(){return t++}},getSubid=function(e,r){var t=_getShortenSubid(r);return e[0]?"&"+e[0]+" "+t:"   "+t},_getShortenSubid=function(e){if(":"===e)return"<Drives>";for(var r=e.split("\\"),t=r.splice(r.length-1,1)[0],n=1;e.length>37&&r[n];)r[n]=r[n].slice(0,1),e=r.join("\\")+"\\"+t,n++;return e};main();
