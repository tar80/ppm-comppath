function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_extends.apply(null,arguments)}var t,e,r,n,tmp=function(){var t=PPx.Extract('%*extract(C,"%%*temp()")');return{dir:t,file:t+"_ppmtemp",lf:t+"_temp.xlf",stdout:t+"_stdout",stderr:t+"_stderr",ppmDir:function(){var t=PPx.Extract("%'temp'%\\ppm");return PPx.Execute("*makedir "+t),t}}},o=PPx.CreateObject("Scripting.FileSystemObject"),create=function(t,e,r,n,i,u){void 0===u&&(u=!1);try{o[t](e,r,u)}catch(a){return n&&o.DeleteFolder(i),[!0,"Could not create "+r]}return[!1,""]},copyFile=function(t,e,r){var n=!1;if(!o.FileExists(t))return[!0,t+" is not exist"];var i=o.GetParentFolderName(e);return o.FolderExists(i)||(o.CreateFolder(i),n=!0),create("CopyFile",t,e,n,i,r)},isEmptyStr=function(t){return""===t};Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var r;if(null==this)throw new TypeError('Array.indexOf: "this" is null or not defined');var n=Object(this),o=n.length>>>0;if(0===o)return-1;var i=null!=e?e:0;if(Math.abs(i)===Infinity&&(i=0),i>=o)return-1;for(r=Math.max(i>=0?i:o-Math.abs(i),0);r<o;){if(r in n&&n[r]===t)return r;r++}return-1}),Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(o){if("function"!=typeof o&&("object"!=typeof o||null==o))throw new TypeError("Object.keys: called on non-object");var i,u,a=[];for(i in o)t.call(o,i)&&a.push(i);if(e)for(u=0;u<n;u++)t.call(o,r[u])&&a.push(r[u]);return a})),function(){if("object"!=typeof JSON){JSON={};var t,e,r,n,o=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,c=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(r,o,i){var u;if(t="",e="","number"==typeof i)for(u=0;u<i;u+=1)e+=" ";else"string"==typeof i&&(e=i);if(n=o,o&&"function"!=typeof o&&("object"!=typeof o||"number"!=typeof o.length))throw new Error("JSON.stringify");return str("",{"":r})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var r;function walk(t,r){var n,o,i=t[r];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&((o=walk(i,n))!==undefined?i[n]=o:delete i[n]);return e.call(t,r,i)}if(t=String(t),s.lastIndex=0,s.test(t)&&(t=t.replace(s,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),o.test(t.replace(i,"@").replace(u,"]").replace(a,"")))return r=Function("return ("+t+")")(),"function"==typeof e?walk({"":r},""):r;throw new Error("JSON.parse")})}function f(t){return t<10?"0"+t:t}function quote(t){return c.lastIndex=0,c.test(t)?'"'+t.replace(c,(function(t){var e=r[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function str(r,o){var i,u,a,c,s,p=t,l=o[r];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(r)),"function"==typeof n&&(l=n.call(o,r,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";if(t+=e,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(c=l.length,i=0;i<c;i+=1)s[i]=str(String(i),l)||"null";return a=0===s.length?"[]":t?"[\n"+t+s.join(",\n"+t)+"\n"+p+"]":"["+s.join(",")+"]",t=p,a}if(n&&"object"==typeof n)for(c=n.length,i=0;i<c;i+=1)"string"==typeof n[i]&&(a=str(u=String(n[i]),l))&&s.push(quote(u)+(t?": ":":")+a);else for(u in l)Object.prototype.hasOwnProperty.call(l,u)&&(a=str(u,l))&&s.push(quote(u)+(t?": ":":")+a);return a=0===s.length?"{}":t?"{\n"+t+s.join(",\n"+t)+"\n"+p+"}":"{"+s.join(",")+"}",t=p,a}return"null"}}();var parseSource=function(t,e){var r=JSON.parse(e.replace(/\\/g,"\\\\"));return r.path="remote"===r.location?PPx.Extract("%*getcust(S_ppm#global:home)")+"\\repo\\"+t:r.path,_extends({name:t},r)},expandSource=function(t){var e=PPx.Extract("%*getcust(S_ppm#sources:"+t+")");return isEmptyStr(e)?undefined:parseSource(t,e)};PPx.Extract('%sgu"ppmcache"');var i=PPx.Extract("%0"),main=function(){var t=JSON.parse(PPx.Extract('%*script(%sgu"ppmlib"\\exeExists.js,7za,7z,curl)')),e=t["7za.exe"]?"7za.exe":t["7z.exe"]?"7z.exe":"";if(!isEmptyStr(e)){var r=t["curl.exe"]?"curl.exe":getCurlPath();if(!isEmptyStr(r)){var n=PPx.Extract("%0");!o.FileExists(n+"fenrirScan.exe")&&setFenrirScan(e,r),!o.FileExists(n+"fenrirScan.ini")&&setInitialFile()}}},getCurlPath=function(){var t=PPx.Extract("%*getcust(S_ppm#global:git)"),e=t+"\\mingw32\\bin\\curl.exe",r=t+"\\mingw64\\bin\\curl.exe";return o.FileExists(e)?e:o.FileExists(r)?r:""},setFenrirScan=function(t,e){var r="fenrir075c.zip",n="http://hp.vector.co.jp/authors/VA026310/products/"+r,o=tmp().dir;PPx.Execute("*cd %sgu'ppmarch'%:%Osbd "+e+" -fsO "+n),PPx.Execute("%Obds "+t+' e -aos -o"'+o+"\" -ir!*omake* \"%sgu'ppmarch'\\"+r+'">nul'),PPx.Execute("%Obds "+t+' e -aos -o"'+o+'" -ir!*fenrirscan* "'+o+'omake.zip">nul'),copyFile(o+"fenrirScan.exe",i),copyFile(o+"fenrirScan.txt",i)},setInitialFile=function(){var t,e=null==(t=expandSource("ppm-comppath"))?void 0:t.path;e&&copyFile(e+"\\ini\\fenrirScan.ini",i)};main();
